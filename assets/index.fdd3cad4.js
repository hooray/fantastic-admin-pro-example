
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{A as e,d as t,Q as a,v as n,R as l,S as o,U as r,r as i,V as s,c as u,y as c,o as d,W as p,F as f,b as v,f as h,G as m,l as y,h as g,w as b,i as k,X as w,Y as O,M as _,m as K,n as x,N as j,Z as C,e as E,$ as S,L as P,E as T,O as L,P as A}from"./index.503ec71c.js";import{E as B}from"./el-input.546a1988.js";import{e as I}from"./eventBus.193de119.js";var M="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function N(e,t,a,n){e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on".concat(t),(function(){a(window.event)}))}function V(e,t){for(var a=t.slice(0,t.length-1),n=0;n<a.length;n++)a[n]=e[a[n].toLowerCase()];return a}function D(e){"string"!=typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),a=t.lastIndexOf("");a>=0;)t[a-1]+=",",t.splice(a,1),a=t.lastIndexOf("");return t}for(var R={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":M?173:189,"=":M?61:187,";":M?59:186,"'":222,"[":219,"]":221,"\\":220},U={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},q={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},G={16:!1,18:!1,17:!1,91:!1},H={},X=1;X<20;X++)R["f".concat(X)]=111+X;var z=[],F=!1,Q="all",W=[],Y=function(e){return R[e.toLowerCase()]||U[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function Z(e){Q=e||"all"}function $(){return Q||"all"}var J=function(e){var t=e.key,a=e.scope,n=e.method,l=e.splitKey,o=void 0===l?"+":l;D(t).forEach((function(e){var t=e.split(o),l=t.length,r=t[l-1],i="*"===r?"*":Y(r);if(H[i]){a||(a=$());var s=l>1?V(U,t):[];H[i]=H[i].filter((function(e){return!((!n||e.method===n)&&e.scope===a&&function(e,t){for(var a=e.length>=t.length?e:t,n=e.length>=t.length?t:e,l=!0,o=0;o<a.length;o++)-1===n.indexOf(a[o])&&(l=!1);return l}(e.mods,s))}))}}))};function ee(e,t,a,n){var l;if(t.element===n&&(t.scope===a||"all"===t.scope)){for(var o in l=t.mods.length>0,G)Object.prototype.hasOwnProperty.call(G,o)&&(!G[o]&&t.mods.indexOf(+o)>-1||G[o]&&-1===t.mods.indexOf(+o))&&(l=!1);(0!==t.mods.length||G[16]||G[18]||G[17]||G[91])&&!l&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function te(e,t){var a=H["*"],n=e.keyCode||e.which||e.charCode;if(ae.filter.call(this,e)){if(93!==n&&224!==n||(n=91),-1===z.indexOf(n)&&229!==n&&z.push(n),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var a=q[t];e[t]&&-1===z.indexOf(a)?z.push(a):!e[t]&&z.indexOf(a)>-1?z.splice(z.indexOf(a),1):"metaKey"===t&&e[t]&&3===z.length&&(e.ctrlKey||e.shiftKey||e.altKey||(z=z.slice(z.indexOf(a))))})),n in G){for(var l in G[n]=!0,U)U[l]===n&&(ae[l]=!0);if(!a)return}for(var o in G)Object.prototype.hasOwnProperty.call(G,o)&&(G[o]=e[q[o]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===z.indexOf(17)&&z.push(17),-1===z.indexOf(18)&&z.push(18),G[17]=!0,G[18]=!0);var r=$();if(a)for(var i=0;i<a.length;i++)a[i].scope===r&&("keydown"===e.type&&a[i].keydown||"keyup"===e.type&&a[i].keyup)&&ee(e,a[i],r,t);if(n in H)for(var s=0;s<H[n].length;s++)if(("keydown"===e.type&&H[n][s].keydown||"keyup"===e.type&&H[n][s].keyup)&&H[n][s].key){for(var u=H[n][s],c=u.splitKey,d=u.key.split(c),p=[],f=0;f<d.length;f++)p.push(Y(d[f]));p.sort().join("")===z.sort().join("")&&ee(e,u,r,t)}}}function ae(e,t,a){z=[];var n=D(e),l=[],o="all",r=document,i=0,s=!1,u=!0,c="+",d=!1;for(void 0===a&&"function"==typeof t&&(a=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(r=t.element),t.keyup&&(s=t.keyup),void 0!==t.keydown&&(u=t.keydown),void 0!==t.capture&&(d=t.capture),"string"==typeof t.splitKey&&(c=t.splitKey)),"string"==typeof t&&(o=t);i<n.length;i++)l=[],(e=n[i].split(c)).length>1&&(l=V(U,e)),(e="*"===(e=e[e.length-1])?"*":Y(e))in H||(H[e]=[]),H[e].push({keyup:s,keydown:u,scope:o,mods:l,shortcut:n[i],method:a,key:n[i],splitKey:c,element:r});void 0!==r&&!function(e){return W.indexOf(e)>-1}(r)&&window&&(W.push(r),N(r,"keydown",(function(e){te(e,r)}),d),F||(F=!0,N(window,"focus",(function(){z=[]}),d)),N(r,"keyup",(function(e){te(e,r),function(e){var t=e.keyCode||e.which||e.charCode,a=z.indexOf(t);if(a>=0&&z.splice(a,1),e.key&&"meta"===e.key.toLowerCase()&&z.splice(0,z.length),93!==t&&224!==t||(t=91),t in G)for(var n in G[t]=!1,U)U[n]===t&&(ae[n]=!1)}(e)}),d))}var ne={setScope:Z,getScope:$,deleteScope:function(e,t){var a,n;for(var l in e||(e=$()),H)if(Object.prototype.hasOwnProperty.call(H,l))for(a=H[l],n=0;n<a.length;)a[n].scope===e?a.splice(n,1):n++;$()===e&&Z(t||"all")},getPressedKeyCodes:function(){return z.slice(0)},isPressed:function(e){return"string"==typeof e&&(e=Y(e)),-1!==z.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,a=t.tagName,n=!0;return!t.isContentEditable&&("INPUT"!==a&&"TEXTAREA"!==a&&"SELECT"!==a||t.readOnly)||(n=!1),n},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(H).forEach((function(a){var n=H[a].find((function(a){return a.scope===t&&a.shortcut===e}));n&&n.method&&n.method()}))},unbind:function(e){if(void 0===e)Object.keys(H).forEach((function(e){return delete H[e]}));else if(Array.isArray(e))e.forEach((function(e){e.key&&J(e)}));else if("object"==typeof e)e.key&&J(e);else if("string"==typeof e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var l=a[0],o=a[1];"function"==typeof l&&(o=l,l=""),J({key:e,scope:l,method:o,splitKey:"+"})}},keyMap:R,modifier:U,modifierMap:q};for(var le in ne)Object.prototype.hasOwnProperty.call(ne,le)&&(ae[le]=ne[le]);if("undefined"!=typeof window){var oe=window.hotkeys;ae.noConflict=function(e){return e&&window.hotkeys===ae&&(window.hotkeys=oe),ae},window.hotkeys=ae}const re=e=>(L("data-v-d4eefa2e"),e=e(),A(),e),ie={class:"container"},se={key:0,class:"tips"},ue={class:"tip"},ce=re((()=>m("span",null,"Alt",-1))),de=O("+"),pe=re((()=>m("span",null,"S",-1))),fe={class:"tip"},ve={class:"tip"},he={class:"tip"},me=re((()=>m("span",null,"ESC",-1))),ye=["href","target","onClick","onMouseover"],ge={class:"icon"},be={class:"info"},ke={class:"title"},we={class:"breadcrumb"},Oe={class:"path"},_e=t({name:"Search"}),Ke=e(Object.assign(_e,{setup(e){const{t:t}=a(),L=n(),A=l(),M=o(),N=r("generateI18nTitle"),V=i(!1),D=i(""),R=i([]),U=i(-1),q=i(),G=i(),H=i([]),X=e=>H.value.push(e);s((()=>{H.value=[]}));const z=u((()=>{let e=[];return e=R.value.filter((e=>{let t=!1;return N(e.i18n,e.title).indexOf(D.value)>=0&&(t=!0),e.path.indexOf(D.value)>=0&&(t=!0),e.breadcrumb.some((e=>N(e.i18n,e.title).indexOf(D.value)>=0))&&(t=!0),t})),e}));function F(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let t=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(t=!1):t=!1,t}(e)){let t=e.meta.baseBreadcrumb?p(e.meta.baseBreadcrumb):[];t.push({title:e.meta.title,i18n:e.meta.i18n});let a=p(e.children);a.map((a=>{a.meta.baseIcon=e.meta.icon||e.meta.baseIcon,a.meta.baseBreadcrumb=t,a.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),F(a)}else{let t=[];e.meta.baseBreadcrumb&&(t=p(e.meta.baseBreadcrumb)),t.push({title:e.meta.title,i18n:e.meta.i18n});let a="";a=S(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,R.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:t,path:a})}}))}function Q(){z.value.length&&(U.value-=1,U.value<0&&(U.value=z.value.length-1),Z())}function W(){z.value.length&&(U.value+=1,U.value>z.value.length-1&&(U.value=0),Z())}function Y(){-1!==U.value&&H.value[U.value].click()}function Z(){let e=0;if(-1!==U.value){e=G.value.scrollTop;const t=H.value[U.value].offsetTop,a=H.value[U.value].clientHeight,n=G.value.scrollTop,l=G.value.clientHeight;t+a>n+l?e=t+a-l:t<=n&&(e=t)}G.value.scrollTo({top:e})}return c((()=>V.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),G.value.scrollTop=0,ae("up",Q),ae("down",W),ae("enter",Y),setTimeout((()=>{q.value.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),ae.unbind("up",Q),ae.unbind("down",W),ae.unbind("enter",Y),setTimeout((()=>{D.value="",U.value=-1}),500))})),c((()=>z.value),(()=>{U.value=-1,Z()})),d((()=>{I.on("global-search-toggle",(()=>{V.value=!V.value})),ae("alt+s",(e=>{L.toolbar.enableNavSearch&&(e.preventDefault(),V.value=!0)})),ae("esc",(e=>{L.toolbar.enableNavSearch&&(e.preventDefault(),V.value=!1)})),"filesystem"!==L.app.routeBaseOn?A.routes.map((e=>{F(e.children)})):M.menus.map((e=>{F(e.children)}))})),(e,a)=>{const n=P,l=T,o=B,r=f("router-link");return v(),h("div",{id:"search",class:x({searching:V.value}),onClick:a[3]||(a[3]=e=>V.value&&k(I).emit("global-search-toggle"))},[m("div",ie,[m("div",{class:"search-box",onClick:a[2]||(a[2]=y((()=>{}),["stop"]))},[g(o,{ref_key:"inputRef",ref:q,modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),placeholder:k(t)("app.search.input"),clearable:"",onKeydown:[a[1]||(a[1]=w((e=>k(I).emit("global-search-toggle")),["esc"])),w(y(Q,["prevent"]),["up"]),w(y(W,["prevent"]),["down"]),w(y(Y,["prevent"]),["enter"])]},{prefix:b((()=>[g(l,null,{default:b((()=>[g(n,{name:"i-ep:search"})])),_:1})])),_:1},8,["modelValue","placeholder","onKeydown"]),"pc"===k(L).mode?(v(),h("div",se,[m("div",ue,[ce,de,pe,O(" "+_(k(t)("app.search.alt_s")),1)]),m("div",fe,[m("span",null,[g(l,null,{default:b((()=>[g(n,{name:"i-ant-design:caret-up-filled"})])),_:1})]),m("span",null,[g(l,null,{default:b((()=>[g(n,{name:"i-ant-design:caret-down-filled"})])),_:1})]),O(" "+_(k(t)("app.search.up_down")),1)]),m("div",ve,[m("span",null,[g(l,null,{default:b((()=>[g(n,{name:"i-ion:md-return-left"})])),_:1})]),O(" "+_(k(t)("app.search.enter")),1)]),m("div",he,[me,O(" "+_(k(t)("app.search.esc")),1)])])):K("v-if",!0)]),m("div",{ref_key:"resultRef",ref:G,class:x(["result",{mobile:"mobile"===k(L).mode}])},[(v(!0),h(j,null,C(k(z),((e,t)=>(v(),E(r,{key:e.path,custom:"",to:V.value?e.path:""},{default:b((({href:a,navigate:o})=>[m("a",{ref_for:!0,ref:X,href:k(S)(e.path)?e.path:a,class:x(["item",{actived:t===U.value}]),target:k(S)(e.path)?"_blank":"_self",onClick:o,onMouseover:e=>U.value=t},[m("div",ge,[e.icon?(v(),E(l,{key:0},{default:b((()=>[g(n,{name:e.icon},null,8,["name"])])),_:2},1024)):K("v-if",!0)]),m("div",be,[m("div",ke,_(k(N)(e.i18n,e.title)),1),m("div",we,[(v(!0),h(j,null,C(e.breadcrumb,((e,t)=>(v(),h("span",{key:t},[O(_(k(N)(e.i18n,e.title))+" ",1),g(l,null,{default:b((()=>[g(n,{name:"i-ep:arrow-right"})])),_:1})])))),128))]),m("div",Oe,_(e.path),1)])],42,ye)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-d4eefa2e"]]),xe=Object.freeze(Object.defineProperty({__proto__:null,default:Ke},Symbol.toStringTag,{value:"Module"}));export{Ke as S,ae as h,xe as i};
