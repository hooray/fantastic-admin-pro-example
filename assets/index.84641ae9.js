
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{A as e,d as a,Z as t,v as l,$ as s,F as n,W as r,r as i,c as u,y as o,o as c,a0 as d,I as p,b as h,f as m,J as v,l as f,h as b,w as $,i as g,a1 as y,a2 as k,R as _,m as w,n as B,S as x,X as S,e as T,P as j,O as I,Q as O,E as P,U as C,V}from"./index.252503d3.js";import{E}from"./el-input.dc2b6950.js";import"./event.d298a7ab.js";const q=e=>(C("data-v-06cbe43e"),e=e(),V(),e),A={class:"container"},D={key:0,class:"tips"},H={class:"tip"},K=q((()=>v("span",null,"Alt",-1))),L=k("+"),M=q((()=>v("span",null,"S",-1))),N={class:"tip"},U={class:"tip"},F={class:"tip"},J=q((()=>v("span",null,"ESC",-1))),Q=["href","target","onClick","onMouseover"],R={class:"icon"},W={class:"info"},X={class:"title"},Z={class:"breadcrumb"},z={class:"path"},G=a({name:"Search"}),Y=e(Object.assign(G,{setup(e){const{proxy:a}=I(),{t:C}=t(),V=l(),q=s(),G=n(),Y=r("generateI18nTitle"),ee=i(!1),ae=i(""),te=i([]),le=i(-1),se=u((()=>{let e=[];return e=te.value.filter((e=>{let a=!1;return Y(e.i18n,e.title).indexOf(ae.value)>=0&&(a=!0),e.path.indexOf(ae.value)>=0&&(a=!0),e.breadcrumb.some((e=>Y(e.i18n,e.title).indexOf(ae.value)>=0))&&(a=!0),a})),e}));function ne(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?d(e.meta.baseBreadcrumb):[];a.push({title:e.meta.title,i18n:e.meta.i18n});let t=d(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),ne(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=d(e.meta.baseBreadcrumb)),a.push({title:e.meta.title,i18n:e.meta.i18n});let t="";t=j(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,te.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t})}}))}function re(){se.value.length&&(le.value-=1,le.value<0&&(le.value=se.value.length-1),oe())}function ie(){se.value.length&&(le.value+=1,le.value>se.value.length-1&&(le.value=0),oe())}function ue(){-1!==le.value&&a.$refs[`search-item-${le.value}`][0].click()}function oe(){let e=0;if(-1!==le.value){e=a.$refs.search.scrollTop;const t=a.$refs[`search-item-${le.value}`][0].offsetTop,l=a.$refs[`search-item-${le.value}`][0].clientHeight,s=a.$refs.search.scrollTop,n=a.$refs.search.clientHeight;t+l>s+n?e=t+l-n:t<=s&&(e=t)}a.$refs.search.scrollTo({top:e})}return o((()=>ee.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),a.$refs.search.scrollTop=0,a.$hotkeys("up",re),a.$hotkeys("down",ie),a.$hotkeys("enter",ue),setTimeout((()=>{a.$refs.input.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),a.$hotkeys.unbind("up",re),a.$hotkeys.unbind("down",ie),a.$hotkeys.unbind("enter",ue),setTimeout((()=>{ae.value="",le.value=-1}),500))})),o((()=>se.value),(()=>{le.value=-1,oe()})),c((()=>{a.$eventBus.on("global-search-toggle",(()=>{ee.value=!ee.value})),a.$hotkeys("alt+s",(e=>{V.toolbar.enableNavSearch&&(e.preventDefault(),ee.value=!0)})),a.$hotkeys("esc",(e=>{V.toolbar.enableNavSearch&&(e.preventDefault(),ee.value=!1)})),"filesystem"!==V.app.routeBaseOn?q.routes.map((e=>{ne(e.children)})):G.menus.map((e=>{ne(e.children)}))})),(e,a)=>{const t=O,l=P,s=E,n=p("router-link");return h(),m("div",{id:"search",class:B({searching:ee.value}),onClick:a[3]||(a[3]=a=>ee.value&&e.$eventBus.emit("global-search-toggle"))},[v("div",A,[v("div",{class:"search-box",onClick:a[2]||(a[2]=f((()=>{}),["stop"]))},[b(s,{ref:"input",modelValue:ae.value,"onUpdate:modelValue":a[0]||(a[0]=e=>ae.value=e),placeholder:g(C)("app.search.input"),clearable:"",onKeydown:[a[1]||(a[1]=y((a=>e.$eventBus.emit("global-search-toggle")),["esc"])),y(f(re,["prevent"]),["up"]),y(f(ie,["prevent"]),["down"]),y(f(ue,["prevent"]),["enter"])]},{prefix:$((()=>[b(l,null,{default:$((()=>[b(t,{name:"i-ep:search"})])),_:1})])),_:1},8,["modelValue","placeholder","onKeydown"]),"pc"===g(V).mode?(h(),m("div",D,[v("div",H,[K,L,M,k(" "+_(g(C)("app.search.alt_s")),1)]),v("div",N,[v("span",null,[b(l,null,{default:$((()=>[b(t,{name:"i-ant-design:caret-up-filled"})])),_:1})]),v("span",null,[b(l,null,{default:$((()=>[b(t,{name:"i-ant-design:caret-down-filled"})])),_:1})]),k(" "+_(g(C)("app.search.up_down")),1)]),v("div",U,[v("span",null,[b(l,null,{default:$((()=>[b(t,{name:"i-ion:md-return-left"})])),_:1})]),k(" "+_(g(C)("app.search.enter")),1)]),v("div",F,[J,k(" "+_(g(C)("app.search.esc")),1)])])):w("v-if",!0)]),v("div",{ref:"search",class:B(["result",{mobile:"mobile"===g(V).mode}])},[(h(!0),m(x,null,S(g(se),((e,a)=>(h(),T(n,{key:e.path,custom:"",to:ee.value?e.path:""},{default:$((({href:s,navigate:n})=>[v("a",{ref_for:!0,ref:`search-item-${a}`,href:g(j)(e.path)?e.path:s,class:B(["item",{actived:a===le.value}]),target:g(j)(e.path)?"_blank":"_self",onClick:n,onMouseover:e=>le.value=a},[v("div",R,[e.icon?(h(),T(l,{key:0},{default:$((()=>[b(t,{name:e.icon},null,8,["name"])])),_:2},1024)):w("v-if",!0)]),v("div",W,[v("div",X,_(g(Y)(e.i18n,e.title)),1),v("div",Z,[(h(!0),m(x,null,S(e.breadcrumb,((e,a)=>(h(),m("span",{key:a},[k(_(g(Y)(e.i18n,e.title))+" ",1),b(l,null,{default:$((()=>[b(t,{name:"i-ep:arrow-right"})])),_:1})])))),128))]),v("div",z,_(e.path),1)])],42,Q)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-06cbe43e"]]);export{Y as default};
